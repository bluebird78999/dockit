<link type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet" />
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
<h1 id="how-to-customize-native-apis-">How<a href=""></a> to customize native APIs ?</h1>
<p><a href="https://github.com/weexteam/article/wiki/%E6%AC%A2%E8%BF%8E%E5%8F%82%E4%B8%8EWeex%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91"  class="weex-translate incomplete">cn</a></p>
<p>Weex SDK provides only rendering capability, rather than having other capabilities, such as network, picture, and URL redirection. If you want the these features, you need to implement them yourselves.<br>The example below will describe how to extend weex with native logic or &#39;bridge&#39; your existed native code.</p>
<h2 id="a-urlhelper-example">A URLHelper Example</h2>
<h3 id="create-your-own-wxmodule-in-native-">Create your own <code>WXModule</code> in native:</h3>
<pre><code class="lang-java">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">URLHelperModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WXModule</span></span>{
    <span class="hljs-keyword">private</span> static <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-type">WEEX_CATEGORY</span>=<span class="hljs-string">"com.taobao.android.intent.category.WEEX"</span>;
    <span class="hljs-meta">@WXModuleAnno</span>
    public void openURL(<span class="hljs-type">String</span> url){
        <span class="hljs-keyword">if</span> (<span class="hljs-type">TextUtils</span>.isEmpty(url)) {
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-type">StringBuilder</span> builder=<span class="hljs-keyword">new</span> <span class="hljs-type">StringBuilder</span>(<span class="hljs-string">"http:"</span>);
        builder.append(url);
        <span class="hljs-type">Uri</span> uri = <span class="hljs-type">Uri</span>.parse(builder.toString());
        <span class="hljs-type">Intent</span> intent = <span class="hljs-keyword">new</span> <span class="hljs-type">Intent</span>(<span class="hljs-type">Intent</span>.<span class="hljs-type">ACTION_VIEW</span>, uri);
        intent.addCategory(<span class="hljs-type">WEEX_CATEGORY</span>);
        mWXSDKInstance.getContext().startActivity(intent);
    }
}
</code></pre>
<p>Notice the <code>@WXModuleAnno</code>, use this annotation to mark the methods you wanna expose to javascript.<br>If your also want to callback to javascript, you should define a <code>callbackId</code> parameter to received &#39;JS callback function id&#39;:</p>
<pre><code class="lang-java">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">URLHelperModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WXModule</span></span>{

    <span class="hljs-meta">@WXModuleAnno</span>
    public void openURL(<span class="hljs-type">String</span> url,<span class="hljs-type">String</span> callbackId){
        <span class="hljs-comment">//...</span>
        <span class="hljs-comment">//callback to javascript </span>
        <span class="hljs-type">Map</span>&lt;<span class="hljs-type">String</span>, <span class="hljs-type">Object</span>&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-type">HashMap</span>&lt;<span class="hljs-type">String</span>, <span class="hljs-type">Object</span>&gt;();
        result.put(<span class="hljs-string">"ts"</span>, <span class="hljs-type">System</span>.currentTimeMillis());
        <span class="hljs-type">WXBridgeManager</span>.getInstance().callback(mWXSDKInstance.getInstanceId(), callbackId, result);
    }
}
</code></pre>
<h3 id="register-your-module-to-engine-">Register your module to engine:</h3>
<pre><code><span class="hljs-keyword">try</span> {
     WXSDKEngine.registerModule(<span class="hljs-string">"myURL"</span>, URLHelperModule.<span class="hljs-keyword">class</span>);<span class="hljs-comment">//'myURL' is the name you'll use in javascript</span>
    } <span class="hljs-keyword">catch</span> (WXException e) {
       WXLogUtils.e(e.getMessage());
    }
</code></pre><h3 id="now-you-can-use-eventmodule-in-javascript-like-this-">Now, you can use eventModule in javascript like this:</h3>
<pre><code class="lang-javascript"><span class="hljs-keyword">let</span> URLHelper = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@weex-module/myURL'</span>);<span class="hljs-comment">//same as you registered</span>
URLHelper.openURL(<span class="hljs-string">"http://www.taobao.com"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ts</span>)</span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"url is open at "</span>+ts);
});
</code></pre>
<h2 id="things-you-need-to-note-">Things you need to note:</h2>
<ol>
<li>Customized components must inherit from <code>WXModule</code>;</li>
<li>@WXModuleAnno annotation must be added, as it is the only way to be recognized by Weex;</li>
<li>The access levels of method must be <strong>public</strong>;</li>
<li>The module class also can not be an inner class;</li>
<li>Customized components should not be obfuscated by tools like ProGuard;</li>
<li>Module methods will be invoked on the UI thread, so do not put time-consuming operations there;</li>
<li>Weex parameter&#39;s type can be int, double, float, String, Map, List, self-defined class that implements WXObject interface;</li>
</ol>

